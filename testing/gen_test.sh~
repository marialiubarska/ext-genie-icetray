#!/bin/bash

genie_app=$MYGENIE/genie/gicevgen
hepev_writer=$MYGENIE/genie/hepevt_writer
hepev_reader=/home/mliubar/Software/genie_workspace/hepevt-reader/new_scripts/step_1_external_genie.py

filename=$1
nu_type=$2
runnumber=$3
filename=$filename.$nu_type.$runnumber
nevents=5
en_min=10
en_max=100

echo "------------------------"
echo "filename: $filename"
echo "nevents: $nevents"

echo "------------------------"

# gen root file
echo "Generating root file"
$genie_app -r $runnumber -o $filename -n $nevents -e $en_min,$en_max -t 1000080160[0.95],1000010010[0.05] -z 0,90 -a 0,360 -R 1300 -L 5000 --nu-type $nu_type --nu-fraction 0.7 --gamma 2 --cross-sections /home/mliubar/Software/genie_workspace/genie-generator/xsec_splines/GENIE_2_12_8_Water_splines.xml --force-singleprob-scale --seed $runnumber 

# conv to hepev
echo "Converting root to hepev"
$hepev_writer -f $filename -o $filename.hepev

# gzip
echo "Gzipping hepev"
gzip -f $filename.hepev

# conv to i3
echo "converting hepev.gz to i3"
$i3env python $hepev_reader -i $filename.hepev.gz -o $filename.i3 -n $nevents

echo "Done!"
